<!DOCTYPE html>
<html>
  <head>
  <!-- meta http-equiv="Content-Type" content="text/html; charset=UTF-8" -->
  <meta charset="UTF-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <link rel="stylesheet" type="text/css" href="sa.css">
  <title>Attack For SSH Channel Integrity By Sequence Number Manipulation</title>
</head>

<body>
  <h1>Attack For SSH Channel Integrity By Sequence Number Manipulation</h1>
  <p>
    Release date: December 19, 2023<br />
    Last Update: December 20, 2023
  </p>

  <h2>Overview</h2>
  <p>
   An attack that breaks SSH channel integrity with message manipulation by Meddler-in-the-Middle (MitM) was found in SSH protocol.
  </p>

  <h2>Affected Tera Term version</h2>
  <p>
    Tera Term 5.0 (TTSSH 3.0) or earlier. And Tera Term 4.107 (TTSSH 2.93) or earlier.
  </p>

  <h2>Impact</h2>
  <p>
    Meddler-in-the-Middle (MitM) can manipulate sequence number by inserting message. It can break SSH channel Integrity. MitM can delete EXT_INFO message from server and client, thereby disabling extensions that increase safety.<br>
    This attack is established when cipher algorithm is chacha20-poly1305@openssh.com or CBC ciper algorithm with EtM (Encrypt-then-MAC) MAC (Message Authentication Code) algorithm.<br>
    It is unpreventable by conventional SSH key exchange procedure.
  </p>

  <h2>Solution</h2>
  <p>
    Please use Tera Term 5.1 (TTSSH 3.1).<br >
    If you cannot update to Tera Term version 5.x, Please use Tera Term 4.108 (TTSSH 2.94).
  </p>
  <p>
    To avoid this attack, "strict key exchange" extension is devised. To use "strict key exchange", both server and client have to support it.<br>
    Tera Term 5.1 and Tera Term 4.108 support "strict key exchange."<br>
    Confirm to the server administrator whether or not the connecting server supports "strict key exchange."
  </p>

  <h2>Workaround</h2>
  <p>
    If you use earlier version by necessity or peer SSH server is not support "strict key exchange", to reduce impact, disable cipher algorithm chacha20-poly1305@openssh.com and MAC algorithm *-etm@openssh.com.<br>
    However, depending on which algorithms are enabled, the strength of algorithms will be reduced by disabling these algorithms. Please consider setting by taking into account both impacts.
  </p>

  <h2>References</h2>
  <ul>
    <li><a href="https://terrapin-attack.com">Terrapin Attack</a></li>
    <li><a href="https://www.cve.org/CVERecord?id=CVE-2023-48795">CVE-2023-48795<a></li>
  </ul>

  <h2>Acknowledgment</h2>
  <p>
    Thank you for Fabian Bäumer, Marcus Brinkmann and Jörg Schwenk, discoverer of this vulnerability.
  </p>

  <h2>History</h2>
  <ul>
    <li>December 19, 2023 First release</li>
    <li>December 20, 2023 Modified description of Impact</li>
  </ul>
</body>
</html>
