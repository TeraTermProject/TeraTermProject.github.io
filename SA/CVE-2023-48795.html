<!DOCTYPE html>
<html>
<head>
  <!-- meta http-equiv="Content-Type" content="text/html; charset=UTF-8" -->
  <meta charset="UTF-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <link rel="stylesheet" type="text/css" href="sa.css">
  <title>シーケンス番号操作によるSSH通信の完全性への攻撃</title>
</head>

<body>
  <h1>シーケンス番号操作によるSSH通信の完全性への攻撃</h1>
  <p>
    公開日: 2023-12-19<br />
    最終更新日: 2023-12-20
  <p>
  </p>

  <h2>概要</h2>
  <p>
   SSHプロトコルに、中間者がメッセージを操作し、SSH通信路の完全性 (Integrity) を破る攻撃が発見されました。
  </p>

  <h2>影響を受ける Tera Term バージョン</h2>
  <p>
    Tera Term バージョン 5.0 (TTSSH 3.0)、Tera Term バージョン 4.107 (TTSSH 2.93) およびそれ以前のバージョン。
  </p>

  <h2>影響</h2>
  <p>
    中間者がメッセージを挟むことでシーケンス番号を操作し、SSH通信路の完全性 (Integrity) を破ることが可能です。この問題を利用すると、中間者はサーバまたはクライアントが送信したEXT_INFOメッセージを削除し、安全性を高める拡張機能を無効にすることができます。<br>
    この中間者攻撃は暗号方式に chacha20-poly1305@openssh.com を使っている場合、または CBC 暗号方式と EtM (Encrypt-then-MAC) MAC (Message Authentication Code) 方式を組み合わせて使っている場合に成立し得ます。<br>
    この問題は従来の SSH の鍵交換手順では防ぐことができません。
  </p>

  <h2>対応方法</h2>
  <p>
    Tera Term バージョン 5.1 (TTSSH 3.1) を利用してください。<br>
    Tera Term 5.x へアップデートできない場合は Tera Term 4.108 (TTSSH 2.94) を利用してください。
  </p>
  <p>
    この攻撃を回避するために "strict key exchange" (厳密な鍵交換) 拡張機能が考案されました。"strict key exchange" を使用するには、サーバ・クライアント両者が対応している必要があります。<br>
    Tera Term 5.1 と Tera Term 4.108 は "strict key exchange" をサポートしています。<br>
    接続先のサーバが "strict key exchange" をサポートしているかどうかは、サーバ管理者に確認してください。
  </p>

  <h2>回避方法</h2>
  <p>
    やむを得ず旧バージョンを利用する場合や、接続先サーバが "strict key exchange" に対応していない場合は、暗号方式 chacha20-poly1305@openssh.com と MAC 方式 *-etm@openssh.com を無効にすることで影響を軽減できます。<br>
    一方これらを無効にすることで、ほかに有効になっている方式によっては、使われる方式の強度が低くなります。影響を勘案して設定を検討してください。
  </p>

 
  <h2>関連情報</h2>
  <ul>
    <li><a href="https://terrapin-attack.com">Terrapin Attack</a></li>
    <li><a href="https://www.cve.org/CVERecord?id=CVE-2023-48795">CVE-2023-48795<a></li>
  </ul>
  

  <h2>謝辞</h2>
  <p>
    この脆弱性を発見した Fabian Bäumer, Marcus Brinkmann, Jörg Schwenk 氏に感謝します。
  </p>

  <h2>更新履歴</h2>
  <ul>
    <li>2023-12-19 脆弱性情報公開</li>
    <li>2023-12-20 「影響」の説明を調整</li>
  </ul>
</body>
</html>
