<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Tera Term 5 への移行</title>
    <META http-equiv="Content-Style-Type" content="text/css">
    <link rel="stylesheet" href="../style.css" type="text/css">
  </head>

  <body>
    <h1>Tera Term 5 について</h1>
    Tera Term 5 は Tera Term 4 の Unicode化を進めた次のバージョンです。
    
    <h2 id="feature">特徴</h2>
    <ul>
      <li>ターミナル(内部バッファ、描画、キー入力)のUnicode化
        <ul>
          <li>多言語の同時表示ができます。<br>
            Tera Term 4 では、例えば日本語を表示する設定にしていると中国語は表示できませんでした</li>
          <li>ISO8859-1から16に対応しました。</li>
          <li>ロケールの設定が不要になりました。</li>
        </ul>
      </li>
      <li>Windows UI(メニュー、ダイアログ)のUnicode化<br>
        次の場合でもメニューやダイアログは設定した言語で正しく表示されます。
        <ul>
          <li>"現在のシステムロケール"以外の言語に設定した場合。</li>
          <li>"ワールドワイド言語サポートで Unicode UTF-8 を使用"にチェックが入っている場合。</li>
        </ul>
      </li>
      <li>その他Windows APIのUnicode版への切り替え<br>
        Unicode ファイル名を使用できます。
      </li>
      <li>マクロ
        <ul>
          <li>内部コードがUnicode(UTF-8)になりました。<br>
              Tera Term 4 はACP(日本語Windowsの場合デフォルトでCP932,Shift_JIS)でした。</li>
          <li>ダイアログなどのGUIで多言語表示できます。</li>
        </ul>
      </li>
    </ul>
    
    <h2 id="requirements">動作環境</h2>
    <ul>
      <li><a href="../about/requirements.html">次のページ(動作環境)</a>を参照ください。
      <li>alpha は次の環境でテストを行っています。
        <ul>
          <li>Windows 10, 11</li>
          <li>Cygwin 3.3.4 (most recent version)</li>
        </ul>
      </li>
    </ul>
    
    <h2 id="misc">その他</h2>
    <ul>
      <li><a href="https://osdn.net/projects/ttssh2/wiki/%E6%B1%BA%E5%AE%9A%E4%BA%8B%E9%A0%85#h1-Tera.20Term.205.x" target="_blank">開発ツール,使用ライブラリなど</a>
      <li><a href="https://osdn.net/projects/ttssh2/wiki/UNICODE" target="_blank">実装状況</a>
      <li>LogMeTT, TTLEditor, Collector はインストーラから削除されました。これらはソースが公開されておらず、オープンソースライセンスでもありません。</li>
    </ul>

    <h1 id="migrate">Tera Term 5 へ移行する</h1>

    <p>Tera Term 5 は Tera Term 4 と同居することができます。もっとも、マクロファイル（.TTL）への関連付けはどちらかにしかできません。</p>

    <h2 id="migrate_config">設定ファイル</h2>

    <ul>
      <li>Tera Term 5 は Tera Trem 4用の設定ファイルをそのまま使用できます。</li>
      <ul>
        <li>TERATERM.INI,KEYBOARD.CNFはUnicode対応となりました。
          <ul>
            <li>cygterm.cfgの文字コードは、cygwin 3.3.4ではUTF-8です</li>
          </ul>
        </li>
        <li>Windows 10,11ではiniファイルをUnicode化することができます。<br>
          <ul>
            <li>iniファイルを扱うWin32APIはUnicode対応版を使用します</li>
            <li>cygterm.cfgはWin32APIを使って読み書きしていません</li>
          </ul>
        </li>
        <li>Unicode化したiniファイルの文字コードはUTF-16 (with LE BOM)です。<br>
            Tera Term 4 ではUnicode版APIを使用していないため、Shift_JISで表現できない文字が含まれていると、その項目は正しく扱えませんでした。</li>
        <li>Tera Term 5 は起動時にiniファイルの文字コードを自動的にUnicodeに変換します。</li>
        <li>Tera Term 5 でTERATERM.INI保存時にiniファイルの文字コードを自動的にUnicodeに変換します。<br>
          変換前のファイルはバックアップされています。</li>
      </ul>
      <li>Tera Trem 4 は Tera Term 5 で保存した設定ファイルを読み込めます。</li>
      <ul>
        <li>Tera Trem 4 は Unicode化したiniファイルを読み込めます(Windows 10,11の場合)。<br>
          Shift_JISで表現できない文字が含まれていると、その項目は正しく扱えません。</li>
        <li><a href="../reference/dev/win32api.html#ini_file">Win32API/iniファイル</a>を参照ください</li>
      </ul>
      <li>設定ファイルのデフォルトフォルダが変更されました。
        <ul>
          <li>%APPDATA%\teraterm5\</li>
          <li>Tera Term 4 の設定ファイルをコピーしてください。
            <ul>
              <li>TERATERM.INI</li>
              <li>KEYBOARD.CNF</li>
              <li>cygterm.cfg</li>
            </ul>
          </li>
          <li>ファイルがない場合、ttermpro.exe起動時にデフォルトの設定ファイルがコピーされます。</li>
          <li>4のときは実行ファイルと同じフォルダ(またはVirtual Store)でした。
            <ul>
              <li>My Documents\TERATERM.INI は読み込まれなくなりました。</li>
            </ul>
          </li>
          <li><a href="../setup/folder.html">フォルダについて</a></li>
        </ul>
      </li>
      <li>設定値のデフォルトが変更されました。
        <ul>
          <li><a href="../setup/teraterm-misc.html#HighDPI">DPIAware</a> "off"-&gt;"on"</li>
          <li><a href="../menu/setup-additional.html#ClearOnResize">ClearOnResize</a> "on"-&gt;"off"</li>
          <li><a href="../setup/teraterm-prn.html#ignoremc">PrinterCtrlSequence</a> "on"-&gt;"off"</li>
          <li><a href="../setup/teraterm-ssh.html#AuthBanner">AuthBanner</a> "1"-&gt;"3"</li>
        </ul>
      </li>
    </ul>


    <h2 id="migrate_macro">マクロファイル</h2>

    <ul>
      <li>ファイル(拡張子ttl)の文字コードはUTF-8を推奨します。</li>
      <li>ttlファイル読み込み時、ファイルの文字コードを自動判定してUTF-8に変換して読み込みます。しかし判定を誤ることがあります。<br>
          BOMを付けると確実にUTF-8として読み込むことができます。</li>
      <li>使用できるラベルの個数の上限・変数の個数の上限（数値,文字列,数値配列,文字列配列それぞれ）が 256 から「なし」になりました。</li>
      <li>文字変数の文字列長の上限はTera Term 4と同じ511バイトです。<br>
          漢字などは1文字のバイト数が増加する(例 "あ" は 0x82,0xa0 から 0xe3,0x81,0x82となる)ため、Tera Term 4ではセットできたデータが途切れる可能性があります。</li>
      <li>文字を扱うコマンドの文字長、文字位置(index,pos)の単位はTera Term 4と同じバイトです。<br>
          ただし、内部文字コードが異なるためTera Term 4とは異なる値となります。</li>
      <li>1文字を表すバイト列を壊す文字列操作を行うと、Tera Term 4と同じく文字(文字列)が壊れます。</li>
      <li>Unicode化に合わない仕様、不足している機能がある場合は<a href="../about/contacts.html">お知らせください</a><br>
        次のコマンドは修正予定です
        <dl>
          <dt><a href="../macro/command/code2str.html">code2str</a>, <a href="../macro/command/str2code.html">str2code</a></dt>
          <dd>ASCIIコード値をUnicodeコードポイントへ変更する</dd>
        </dl>
      </li>
    </ul>

    <h2 id="migrate_plugin">プラグイン</h2>

    <ul>
      <li>compat_w95.hは不要となりました。
        <ul>
          <li><a href="https://osdn.net/projects/ttssh2/scm/svn/commits/9129" target="_blank">r9239</a></li>
        </ul>
      </li>
      <li>plugin APIを変更しました。
        <ul>
          <li>ファイル名がUnicode (型が char から wchar_t) になりました。</li>
          <li><a href="https://osdn.net/projects/ttssh2/svn/view/trunk/teraterm/teraterm/ttsetup.h?view=markup&root=ttssh2#l44" target="_blank">trunk/teraterm/ttsetup.h</a></li>
          <li><a href="https://osdn.net/projects/ttssh2/svn/view/branches/4-stable/teraterm/teraterm/ttsetup.h?view=markup&root=ttssh2#l39" target="_blank">4-stable/teraterm/ttsetup.h</a></li>
        </ul>
      </li>
      <li>iniファイル読み書き共通関数を追加しました。
        <ul>
          <li>ファイル名だけをUnicode化して従来と同じ動作をする関数を準備。</li>
          <li><a href="https://osdn.net/projects/ttssh2/svn/view/trunk/teraterm/common/inifile_com.h?view=markup&root=ttssh2" target="_blank">trunk/teraterm/common/inifile_com.h</a></li>
        </ul>
      </li>
      <li>struct tttset (tttypes.h) のメンバを変更しました。
        <ul>
          <li>ファイル名、パス、文字列のメンバには、WがついたUnicode版のメンバが追加。</li>
          <li>ファイル名、パスの文字数はMAX_PATH文字以上になることを考慮。</li>
          <li>まだ変化する予定(メンバ名、順序、サイズ、型などなど)。</li>
        </ul>
      </li>
      <li>通知アイコンのAPIが変更されました。
        <ul>
          <li>高DPIに対応しました。</li>
          <li>SetVerNotifyIcon(), SetCustomNotifyIcon(), GetCustomNotifyIcon() は削除されました。</li>
          <li><a href="https://osdn.net/projects/ttssh2/svn/view/trunk/teraterm/ttpcmn/ttcmn_notify.h?view=markup&root=ttssh2" target="_blank">trunk/teraterm/ttpcmn/ttcmn_notify.h</a></li>
        </ul>
      </li>
      <li>ヘルプAPIを追加。
        <ul>
          <li>Unicodeファイル名に対応したAPIを追加しました。<br>
          <li><a href="https://osdn.net/projects/ttssh2/svn/view/trunk/teraterm/ttpcmn/ttcmn_lib.h?view=markup&root=ttssh2" target="_blank">trunk/teraterm/ttpcmn/ttcmn_lib.h</a></li>
        </ul>
      </li>
    </ul>

  </body>
</html>
